{
  "permissions": {
    "allow": [
      "Bash(git init:*)",
      "Bash(pnpm create:*)",
      "Bash(pnpm install:*)",
      "Bash(npx prisma generate:*)",
      "Bash(npx tsc:*)",
      "Bash(npx vite build:*)",
      "Bash(timeout 5 npx tsx:*)",
      "Bash(gh auth status:*)",
      "Bash(pg_isready:*)",
      "Bash(brew services:*)",
      "Bash(docker --version:*)",
      "Bash(docker compose:*)",
      "Bash(npx prisma migrate:*)",
      "Bash(lsof:*)",
      "Bash(xargs kill -9:*)",
      "Bash(git log:*)",
      "Bash(pnpm build:*)",
      "Bash(git reset:*)",
      "Bash(git add:*)",
      "Bash(git commit -m \"$\\(cat <<''EOF''\nfix: emit socket events when stories are created, updated, or deleted\n\nStories were only persisted via REST but never broadcast through\nSocket.io, so other users in the room never saw new stories and\ncouldn''t vote on them. Added STORY_ADDED, STORY_UPDATED, and\nSTORY_DELETED emissions after each mutation.\n\nCo-Authored-By: Claude Opus 4.6 <noreply@anthropic.com>\nEOF\n\\)\")",
      "Bash(git commit -m \"$\\(cat <<''EOF''\nfix: serialize Prisma Date fields before emitting story events\n\nPrisma returns Date objects for createdAt/updatedAt but the shared\nStory type expects ISO strings. This caused a type mismatch when\nbroadcasting story events via Socket.io.\n\nCo-Authored-By: Claude Opus 4.6 <noreply@anthropic.com>\nEOF\n\\)\")",
      "Bash(git push:*)",
      "Bash(pnpm add:*)",
      "Bash(npx playwright install:*)",
      "Bash(git commit:*)",
      "Bash(git status:*)",
      "Bash(git check-ignore:*)",
      "Bash(gh release edit v1.0.0 --notes \"$\\(cat <<''EOF''\n## ðŸŽ‰ First Stable Release\n\nA full-featured real-time Planning Poker app for scrum teams.\n\n### Features\n- **Authentication** â€” Register, login, JWT with refresh tokens\n- **Rooms** â€” Create rooms, share 6-character join codes, real-time participant list\n- **Stories** â€” Add, edit, delete stories with live Socket.io broadcast to all participants\n- **Voting** â€” Fibonacci / T-Shirt / Powers card scales, live vote-count progress bar\n- **Reveal & Stats** â€” Average, median, consensus level, vote distribution chart\n- **Re-vote & Finalize** â€” Re-vote rounds, accept final estimate per story\n- **History** â€” Track past voting sessions\n\n### Tech Stack\n| Layer | Technology |\n|-------|-----------|\n| Frontend | React 19, Vite 7, Tailwind CSS v4, Zustand |\n| Backend | Express, Socket.io, Prisma ORM |\n| Database | PostgreSQL 16 |\n| Monorepo | Turborepo + pnpm workspaces |\n| Testing | Playwright E2E \\(multi-user\\) |\n\n### Quick Start\n```bash\ngit clone https://github.com/manimovassagh/planning_poker.git\ncd planning_poker\npnpm install\nmake up    # starts PostgreSQL, runs migrations, launches dev servers\nmake down  # stops everything\n```\nEOF\n\\)\")",
      "Bash(while read ref)",
      "Bash(do git update-ref -d \"$ref\")",
      "Bash(done)",
      "Bash(git -C /Users/mani/Documents/Projects/planning_poker log --oneline -20)",
      "Bash(git checkout:*)",
      "Bash(git pull:*)",
      "Bash(gh pr create --title \"feat: End Session button for facilitator\" --body \"$\\(cat <<''EOF''\n## Summary\n- Facilitator can end a planning session via a red \"End Session\" button in the room header\n- All participants see a \"Session Ended\" screen and can navigate back to dashboard\n- New socket events: `ROOM_END_SESSION` \\(clientâ†’server\\) and `ROOM_SESSION_ENDED` \\(serverâ†’broadcast\\)\n\n## Changes\n- `packages/shared/src/events.ts` â€” new events + typed payloads\n- `apps/api/src/socket/roomHandlers.ts` â€” handler that verifies ownership, sets room status to \"completed\"\n- `apps/web/src/routes/RoomPage.tsx` â€” End Session button + session-ended screen\nEOF\n\\)\" --base main)",
      "Bash(gh pr merge:*)",
      "Bash(gh pr create:*)",
      "Bash(vercel --version:*)",
      "Bash(npm i:*)",
      "Bash(git tag:*)",
      "Bash(gh release create:*)",
      "Bash(vercel whoami:*)",
      "Bash(vercel --yes:*)",
      "Bash(vercel link:*)",
      "Bash(gh pr checks:*)",
      "Bash(pnpm lint:*)",
      "Bash(gh run view:*)",
      "Bash(gh run list:*)",
      "Bash(pnpm --filter @planning-poker/api lint:*)",
      "Bash(railway whoami:*)",
      "Bash(git rm:*)",
      "Bash(gh api:*)",
      "Bash(railway:*)",
      "Bash(script -q /dev/null railway add:*)",
      "Bash(script -q:*)",
      "Bash(docker run:*)",
      "Bash(pnpm --filter @planning-poker/shared build:*)",
      "Bash(pnpm --filter @planning-poker/shared clean:*)",
      "Bash(pnpm --filter @planning-poker/web build:*)",
      "Bash(curl:*)",
      "Bash(vercel inspect:*)",
      "Bash(vercel:*)",
      "Bash(git config:*)",
      "Bash(VITE_API_URL=https://api-production-31a2.up.railway.app VITE_WS_URL=https://api-production-31a2.up.railway.app pnpm --filter @planning-poker/web build:*)",
      "Bash(VITE_API_URL=https://api-production-31a2.up.railway.app VITE_WS_URL=https://api-production-31a2.up.railway.app script -q /dev/null vercel build --prod)",
      "Bash(VITE_API_URL=https://api-production-31a2.up.railway.app VITE_WS_URL=https://api-production-31a2.up.railway.app script -q /dev/null vercel build --prod --yes)",
      "Bash(git -C /Users/mani/Documents/Projects/planning_poker status --short)",
      "Bash(git -C /Users/mani/Documents/Projects/planning_poker add:*)",
      "Bash(git -C /Users/mani/Documents/Projects/planning_poker commit -m \"$\\(cat <<''EOF''\ntest\\(e2e\\): add session lifecycle tests from voting through history detail\n\nCovers end-to-end flow: vote â†’ reveal â†’ accept estimate â†’ end session â†’\nhistory page â†’ history detail analytics â†’ back navigation.\nAdds endSession\\(\\) and navigateToHistory\\(\\) helpers.\n\nCo-Authored-By: Claude Opus 4.6 <noreply@anthropic.com>\nEOF\n\\)\")",
      "Bash(git -C /Users/mani/Documents/Projects/planning_poker commit --amend -m \"$\\(cat <<''EOF''\ntest\\(e2e\\): add session lifecycle tests with 4 users through history detail\n\nCovers end-to-end flow with 4 concurrent participants: vote \\(different\nvalues\\) â†’ reveal â†’ accept estimate â†’ end session â†’ all users see ended â†’\nhistory page â†’ history detail analytics with participant count â†’ back nav.\nAdds endSession\\(\\) and navigateToHistory\\(\\) helpers.\n\nCo-Authored-By: Claude Opus 4.6 <noreply@anthropic.com>\nEOF\n\\)\")",
      "Bash(git -C /Users/mani/Documents/Projects/planning_poker log --oneline -6)",
      "Bash(git -C /Users/mani/Documents/Projects/planning_poker push -u origin feat/history-ci-e2e)",
      "Bash(git -C /Users/mani/Documents/Projects/planning_poker commit -m \"$\\(cat <<''EOF''\nfix\\(e2e\\): resolve strict mode violations in auth and lifecycle tests\n\n- auth: use getByRole heading instead of getByText for Dashboard\n- auth: target logout icon button by svg class instead of name\n- lifecycle: use exact match and getByRole to disambiguate Stories text\n\nCo-Authored-By: Claude Opus 4.6 <noreply@anthropic.com>\nEOF\n\\)\")",
      "Bash(git -C /Users/mani/Documents/Projects/planning_poker push)",
      "Bash(grep:*)",
      "Bash(git -C /Users/mani/Documents/Projects/planning_poker checkout -b fix/code-quality)",
      "Bash(pnpm --filter @planning-poker/web lint:*)",
      "Bash(git -C /Users/mani/Documents/Projects/planning_poker commit -m \"$\\(cat <<''EOF''\nfix\\(web\\): resolve react-hooks/exhaustive-deps warning in RoomPage\n\nUse useRoomStore.getState\\(\\) for all store actions inside the useEffect,\nwhich is the idiomatic Zustand pattern for stable action references.\nEliminates the 14-dependency lint warning while keeping identical behavior.\n\nCo-Authored-By: Claude Opus 4.6 <noreply@anthropic.com>\nEOF\n\\)\")",
      "Bash(pnpm --filter @planning-poker/api build:*)",
      "Bash(git -C /Users/mani/Documents/Projects/planning_poker commit -m \"$\\(cat <<''EOF''\nrefactor: remove console.log/error from production socket code\n\nRemove debug logging from socket handlers and client socket setup.\nServer startup log and global error handler console.error are kept.\n\nCo-Authored-By: Claude Opus 4.6 <noreply@anthropic.com>\nEOF\n\\)\")",
      "Bash(git -C /Users/mani/Documents/Projects/planning_poker commit -m \"$\\(cat <<''EOF''\nfix: remove any types in analytics and guard empty distribution\n\nRemove unsafe any casts in analytics route â€” Prisma infers the types.\nGuard ResultsPanel against empty vote distribution which would cause\nMath.max\\(\\) to return -Infinity and break the histogram chart.\n\nCo-Authored-By: Claude Opus 4.6 <noreply@anthropic.com>\nEOF\n\\)\")",
      "Bash(git -C /Users/mani/Documents/Projects/planning_poker log --oneline -4)",
      "Bash(git -C /Users/mani/Documents/Projects/planning_poker push -u origin fix/code-quality)",
      "Bash(ls:*)",
      "Bash(git -C /Users/mani/Documents/Projects/planning_poker checkout -b fix/root-cleanup)",
      "Bash(git -C /Users/mani/Documents/Projects/planning_poker commit -m \"$\\(cat <<''EOF''\nchore: remove unused typescript from root devDependencies\n\nEach workspace package \\(api, web, shared\\) has its own typescript\ndependency. The root one was redundant â€” no tsconfig.json exists at root.\n\nCo-Authored-By: Claude Opus 4.6 <noreply@anthropic.com>\nEOF\n\\)\")",
      "Bash(git -C /Users/mani/Documents/Projects/planning_poker commit -m \"$\\(cat <<''EOF''\nfix: add prisma.schema path to silence Vercel postinstall warning\n\nPrisma''s postinstall hook couldn''t find the schema at the default\nlocation when pnpm install runs at root \\(e.g. on Vercel\\). Adding the\nprisma.schema field in api/package.json tells Prisma where to look.\n\nCo-Authored-By: Claude Opus 4.6 <noreply@anthropic.com>\nEOF\n\\)\")",
      "Bash(git -C /Users/mani/Documents/Projects/planning_poker push -u origin fix/root-cleanup)",
      "Bash(git -C /Users/mani/Documents/Projects/planning_poker checkout main)",
      "Bash(git -C /Users/mani/Documents/Projects/planning_poker pull:*)",
      "Bash(git -C /Users/mani/Documents/Projects/planning_poker checkout:*)",
      "Bash(npx playwright test:*)",
      "Bash(npx eslint:*)",
      "Bash(echo:*)",
      "Bash(gh run watch:*)",
      "Bash(pnpm --filter @planning-poker/api test:*)",
      "Bash(pnpm --filter @planning-poker/web test:*)",
      "WebFetch(domain:docs.railway.com)",
      "WebFetch(domain:blog.railway.com)",
      "WebFetch(domain:github.com)",
      "WebFetch(domain:station.railway.com)",
      "Bash(python3:*)",
      "Bash(node -e:*)",
      "Bash(gh pr view:*)",
      "Bash(gh secret list:*)",
      "Bash(gh secret set:*)",
      "Bash(gh pr edit 17 --title \"feat: deploy frontend to Railway, replace Vercel\" --body \"$\\(cat <<''EOF''\n## Summary\n- Replace Vercel deploy with Railway deploy for the frontend\n- Add `VITE_API_URL` / `VITE_WS_URL` build args to web Dockerfile so Railway can inject the API URL at build time\n- Remove nginx API/WebSocket proxy blocks \\(not needed â€” frontend calls API directly via env vars\\)\n- Both frontend and backend now deploy to Railway after all CI tests pass\n\n## Pipeline\n```\nðŸ“¦ Setup â†’ ðŸ”§ Backend + ðŸŽ¨ Frontend \\(parallel\\) â†’ ðŸ§ª E2E â†’ ðŸš€ Deploy Frontend \\(Railway\\) + ðŸš€ Deploy Backend \\(Railway\\)\n```\n\n## Setup Required After Merge\n1. Create Railway **web** service in the planning-poker project\n2. Set env vars on the web service:\n   - `VITE_API_URL=https://api-production-31a2.up.railway.app`\n   - `VITE_WS_URL=https://api-production-31a2.up.railway.app`\n   - `RAILWAY_DOCKERFILE_PATH=apps/web/Dockerfile`\n3. Add GitHub secret: `RAILWAY_WEB_SERVICE_ID`\n4. Update API service `CORS_ORIGIN` to include the new frontend Railway URL\n\n## Test plan\n- [ ] PR: test jobs pass, deploy jobs skipped\n- [ ] Merge to main: deploy-api succeeds, deploy-web skips gracefully \\(no RAILWAY_WEB_SERVICE_ID yet\\)\n- [ ] After Railway web service setup: deploy-web succeeds\n- [ ] Frontend loads + login + rooms + voting all work\n\nðŸ¤– Generated with [Claude Code]\\(https://claude.com/claude-code\\)\nEOF\n\\)\")",
      "Bash(RAILWAY_TOKEN=b0351d59-9bba-462d-bcf1-da3d99e26dfb railway:*)",
      "Bash(git mv:*)"
    ]
  }
}
